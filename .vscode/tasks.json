{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "shell",
      "label": "func: host start",
      "command": "func",
      "args": [
        "host",
        "start"
      ],
      "problemMatcher": "$func-python-watch",
      "isBackground": true,
      "dependsOn": [
      ],
      "dependsOrder": "sequence",
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app/api",
        "env": {
          "languageWorkers__python__defaultExecutablePath": "${workspaceFolder}\\stock-research-app\\.venv\\Scripts\\python.exe",
          "languageWorkers__python__pythonPath": "${workspaceFolder}\\stock-research-app\\.venv\\Scripts\\python.exe",
          "PYTHONPATH": "${workspaceFolder}\\stock-research-app\\.venv\\Lib\\site-packages",
          "PATH": "${workspaceFolder}\\stock-research-app\\.venv\\Scripts;${env:PATH}"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      }
    },
    {
      "label": "pip install (functions)",
      "type": "shell",
      "windows": {
        "command": "${config:azureFunctions.pythonVenv}\\Scripts\\python -m pip install -U pip setuptools wheel; ${config:azureFunctions.pythonVenv}\\Scripts\\python -m pip uninstall -y azure azure-storage azure-common azure-nspkg; ${config:azureFunctions.pythonVenv}\\Scripts\\python -m pip install -r api\\requirements.txt"
      },
      "linux": {
        "command": "${config:azureFunctions.pythonVenv}/bin/python -m pip install -U pip setuptools wheel && ${config:azureFunctions.pythonVenv}/bin/python -m pip uninstall -y azure azure-storage azure-common azure-nspkg || true && ${config:azureFunctions.pythonVenv}/bin/python -m pip install -r api\\requirements.txt"
      },
      "problemMatcher": [],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app",
        "shell": {
          "executable": "powershell.exe",
          "args": [
            "-NoProfile",
            "-ExecutionPolicy",
            "Bypass",
            "-Command"
          ]
        }
      }
    },
    {
      "label": "Start Azurite (Blob/Queue/Table)",
      "type": "shell",
      "command": "azurite",
      "args": [
        "--silent",
        "--location",
        "${workspaceFolder}/stock-research-app/.data/azurite",
        "--debug",
        "${workspaceFolder}/stock-research-app/.data/azurite/debug.log"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "web: start (static on 5174)",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-NoProfile",
        "-ExecutionPolicy",
        "Bypass",
        "-Command",
        "$ErrorActionPreference='Stop'; if (-not (Get-Command npx -ErrorAction SilentlyContinue)) { Write-Error 'Node.js/npm not found'; exit 1 }; npx serve -s . -l 5174"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app/web"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "web: start (vite dev)",
      "type": "shell",
      "command": "npm",
      "args": [
        "run",
        "dev",
        "--",
        "--port",
        "5174"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app/web"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "func: run via runfunc.cmd",
      "type": "shell",
      "command": ".\\runfunc.cmd",
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app"
      },
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      },
      "problemMatcher": "$func-python-watch"
    },
    {
      "label": "azd: provision",
      "type": "shell",
      "command": "azd",
      "args": [
        "provision"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "azd: deploy",
      "type": "shell",
      "command": "azd",
      "args": [
        "deploy"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "azd: up (provision + deploy)",
      "type": "shell",
      "command": "azd",
      "args": [
        "up"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "azd: down (delete resources)",
      "type": "shell",
      "command": "azd",
      "args": [
        "down"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "bicep: validate infrastructure",
      "type": "shell",
      "command": "az",
      "args": [
        "deployment",
        "sub",
        "validate",
        "--location",
        "eastus",
        "--template-file",
        "infra/main.bicep",
        "--parameters",
        "infra/main.parameters.json"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "web: build",
      "type": "shell",
      "command": "npm",
      "args": [
        "run",
        "build"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app/web"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "api: install dependencies",
      "type": "shell",
      "command": "pip",
      "args": [
        "install",
        "-r",
        "requirements.txt"
      ],
      "options": {
        "cwd": "${workspaceFolder}/stock-research-app/api"
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      },
      "problemMatcher": []
    }    
  ]
}
